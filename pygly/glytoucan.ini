
[sequence]
params = accession, format
format = .*
sparql = 
   	PREFIX glycan: <http://purl.jp/bio/12/glyco/glycan#>
	PREFIX glytoucan: <http://www.glytoucan.org/glyco/owl/glytoucan#>
	
	SELECT DISTINCT ?accession ?format ?sequence
	WHERE {
   	    ?Saccharide glytoucan:has_primary_id ?accession .
   	    ?Saccharide glycan:has_glycosequence ?GlycoSequence .
   	    ?GlycoSequence glycan:has_sequence ?sequence .
   	    ?GlycoSequence glycan:in_carbohydrate_format ?formaturi
            FILTER(regex(?accession,"^%%(accession)s$"))
	    BIND(STRAFTER(STR(?formaturi),"carbohydrate_format_") as ?format)
	    FILTER(regex(?format,"^%%(format)s$"))
	}

[mass]
params = accession
sparql = 
    	PREFIX glytoucan: <http://www.glytoucan.org/glyco/owl/glytoucan#>

    	SELECT DISTINCT ?accession ?mass
    	WHERE {
       	    ?Saccharide glytoucan:has_primary_id ?accession .
       	    ?Saccharide glytoucan:has_derivatized_mass ?massuri
       	    FILTER(regex(?accession, "^%%(accession)s$"))
	    BIND(STRAFTER(STR(?massuri),"derivatization_type_node/") as ?mass)
    	}

[monocount]
params = accession
sparql = 
	PREFIX glycan: <http://purl.jp/bio/12/glyco/glycan#>
	PREFIX glytoucan: <http://www.glytoucan.org/glyco/owl/glytoucan#>
	PREFIX wurcs: <http://www.glycoinfo.org/glyco/owl/wurcs#>
	
	SELECT DISTINCT ?accession ?count
	WHERE {
   	    ?Saccharide glytoucan:has_primary_id ?accession .
   	    ?Saccharide glycan:has_glycosequence ?GlycoSequence .
   	    ?GlycoSequence glycan:in_carbohydrate_format glycan:carbohydrate_format_wurcs . 
	    ?GlycoSequence wurcs:RES_count ?count
	    FILTER(regex(?accession, "^%%(accession)s$"))
	}

[references]
params = accession
sparql = 
        PREFIX glytoucan: <http://www.glytoucan.org/glyco/owl/glytoucan#>
        PREFIX glycan: <http://purl.jp/bio/12/glyco/glycan#>
        PREFIX dcterms: <http://purl.org/dc/terms/>
        
        SELECT DISTINCT ?accession ?ref
        WHERE {
            ?Saccharide glytoucan:has_primary_id ?accession .
            ?Saccharide dcterms:references ?refuri
	    FILTER(regex(?accession, "^%%(accession)s$"))
	    BIND(STRAFTER(STR(?refuri),"references/") as ?ref)
        }


[crossrefs]
params = accession, resource
resource = .*
sparql = 
        PREFIX glycan: <http://purl.jp/bio/12/glyco/glycan#>
        PREFIX glytoucan: <http://www.glytoucan.org/glyco/owl/glytoucan#>

        SELECT DISTINCT ?accession ?resource ?entry
        WHERE {
             ?saccharide glytoucan:has_primary_id ?accession .
             ?saccharide glycan:has_resource_entry ?entryuri
	     FILTER(regex(?accession, "^%%(accession)s$"))
	     FILTER(regex(?entryuri,"//rdf\\.glycoinfo\\.org/"))
	     BIND(STRAFTER(STR($entryuri),"rdf.glycoinfo.org/") as ?both)
	     BIND(STRAFTER(?both,"/") as ?entry)
	     BIND(STRBEFORE(?both,"/") as ?resource)
	     FILTER(regex(?resource, "^%%(resource)s$"))
        } 

[motifs]
params = accession
sparql = 
    	PREFIX glycan: <http://purl.jp/bio/12/glyco/glycan#>
    	PREFIX glytoucan: <http://www.glytoucan.org/glyco/owl/glytoucan#>

    	SELECT DISTINCT ?accession ?motif
    	WHERE {
       	    ?Saccharide glytoucan:has_primary_id ?accession . 
    	    ?Saccharide glycan:has_motif ?MotifURI .
       	    ?MotifURI glytoucan:has_primary_id ?motif
	    FILTER(regex(?accession, "^%%(accession)s$"))
    	}

[allmotif]
sparql = 
	PREFIX glytoucan: <http://www.glytoucan.org/glyco/owl/glytoucan#>
    	PREFIX glycan: <http://purl.jp/bio/12/glyco/glycan#>
	PREFIX rdfs: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
	PREFIX rdf: <http://www.w3.org/2000/01/rdf-schema#>
	
	SELECT DISTINCT ?accession ?label ?redend
	WHERE {
   	    ?Saccharide glytoucan:has_primary_id ?accession . 
	    ?Saccharide rdfs:type glycan:glycan_motif . 
	    ?Saccharide rdf:label ?label .
	    ?Saccharide glytoucan:is_reducing_end ?redend
	}

[exists]
params = accession
sparql = 
	PREFIX glytoucan: <http://www.glytoucan.org/glyco/owl/glytoucan#>
	
	SELECT DISTINCT ?accession
	WHERE {
   	    ?Saccharide glytoucan:has_primary_id ?accession
	    FILTER(regex(?accession, "^%%(accession)s$"))
        } 

[hash]
params = accession
sparql = 
	PREFIX glytoucan: <http://www.glytoucan.org/glyco/owl/glytoucan#>
	
	SELECT DISTINCT ?accession ?hash
	WHERE {
   	    ?Saccharide glytoucan:has_primary_id ?accession . 
	    ?hashuri ?batchaccnum ?Saccharide
	    FILTER(regex(?accession, "^%%(accession)s$"))
	    FILTER(regex(STR(?batchaccnum),"^http://glycosmos\\.org/batch/AccessionNumber/"))
	    BIND(STRAFTER(STR(?hashuri),"http://repository.sparqlite.com/key#") as ?hash)
	}

[taxonomy]
params = accession, taxon
taxon = .*
sparql =
    PREFIX glycan: <http://purl.jp/bio/12/glyco/glycan#>
    PREFIX glytoucan: <http://www.glytoucan.org/glyco/owl/glytoucan#>
    PREFIX skos: <http://www.w3.org/2004/02/skos/core#>

    SELECT DISTINCT ?accession ?taxon
    WHERE {
       {
         ?saccharide glytoucan:has_primary_id ?accession .
         ?saccharide a glycan:saccharide .
         ?saccharide skos:exactMatch ?gdb .
         ?gdb glycan:has_reference ?ref .
         ?ref glycan:is_from_source ?taxonuri
       } UNION {
         ?saccharide glytoucan:has_primary_id ?accession .
         ?saccharide a glycan:saccharide .
         ?saccharide glycan:is_from_source ?taxonuri
       }
       FILTER(regex(?accession, "^%%(accession)s$"))
       FILTER(regex(STR(?taxonuri), "^http://rdf\\.glycoinfo\\.org/source/[0-9]+$"))
       BIND(STRAFTER(STR(?taxonuri),"http://rdf.glycoinfo.org/source/") as ?taxon)
       FILTER(regex(?taxon, "^%%(taxon)s$"))
    }
